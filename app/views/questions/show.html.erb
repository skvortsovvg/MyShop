<style type="text/css">
  * {
     box-sizing: border-box;
}

.question, .edit_question {
  width: 50%;
  height: auto;
  padding:10px;
  margin-bottom: 10px;
}

.title {
  padding:10px;
  font-size: 24px;
  font-weight: bold;
  background-color:#2124;
  border:1px solid black;
}
.text {
  padding:10px;
  margin-bottom: 5px;
  border:1px solid black;
}

h2 {
  margin: 0px;
}

.answers, .answer div {
  margin-left: 20px;
}

.answer {
  margin-top: 10px;
}

.answer_date {
  font-size: 12px;
  font-style: italic;
  color: grey;
}

.edit_answer, .edit_question {
  display: none;
}
</style>

<h1>Question #<%= @question.id %></h1>

<article class="question">
  <%= render @question %>
</article>

<div>
  <% if current_user %>
    <section class="new_answer">
      <%= form_with model: [@question, @question.answers.new], local: false do |form| %>
        <div>
          <%= form.label 'New answer' %><br>
          <%= form.text_area :body, cols: 100, rows: 5 %>
        </div>
        <div>
          <%= form.label :files %><br>
          <%= form.file_field :files, multiple: true %>
        </div>
        <p>
          <%= form.submit 'Add answer' %>
        </p>
      <% end %>
    </section>
  <% end %>

  <section class="answers">
    <h2>Answers:</h2>
    <%= render Question.answers_best_first(@question) %>
  </section>
</div>
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", () => {
    editBtns = document.querySelectorAll(".editBtn");
    editBtns.forEach(function (btn) {
      btn.addEventListener("click", () => {
        answer_section = document.getElementById(
          `answer_${btn.dataset.answerId}`
        );
        answer_section
          .querySelector(".edit_answer")
          .classList.remove("edit_answer");
        answer_section.querySelector(".answer_buttons").style.display = "none";
      });
    });
    editQstBtn = document.querySelector(".editQstBtn");
    editQstBtn.addEventListener("click", () => {
        document.querySelector(".edit_question").style.display = "block";
        document.querySelector(".question_body").style.display = "none";
        document.querySelector(".editQstBtn").style.display = "none";
      });
  });
</script>
